## Hello, World!

เมื่อคุณติดตั้ง Rust เรียบร้อยแล้ว ก็ถึงเวลาเขียนโปรแกรม Rust โปรแกรมแรกของคุณ ตามธรรมเนียมของการเรียนรู้ภาษาใหม่ เราจะเริ่มต้นด้วยการเขียนโปรแกรมเล็กๆ ที่พิมพ์ข้อความว่า `Hello, world!` ออกมาบนหน้าจอ และเราก็จะทำเช่นเดียวกันนี้!

> หมายเหตุ: หนังสือเล่มนี้ตั้งสมมติฐานว่าคุณมีความคุ้นเคยพื้นฐานกับบรรทัดคำสั่ง Rust ไม่ได้มีข้อกำหนดเฉพาะเจาะจงเกี่ยวกับโปรแกรมแก้ไขข้อความ เครื่องมือ หรือตำแหน่งที่เก็บโค้ดของคุณ ดังนั้น หากคุณต้องการใช้ Integrated Development Environment (IDE) แทนบรรทัดคำสั่ง ก็สามารถใช้ IDE ที่คุณชื่นชอบได้เลย ปัจจุบัน IDE หลายตัวรองรับ Rust ในระดับหนึ่ง โปรดดูเอกสารประกอบของ IDE สำหรับรายละเอียดเพิ่มเติม ทีมงาน Rust มุ่งเน้นไปที่การทำให้การรองรับ IDE เป็นเลิศผ่าน `rust-analyzer` ดูรายละเอียดเพิ่มเติมได้ใน
> [Appendix D][devtools]<!-- ignore --> 

### การสร้างไดเรกทอรีโปรเจกต์

คุณจะเริ่มต้นด้วยการสร้างไดเรกทอรีเพื่อเก็บโค้ด Rust ของคุณ Rust ไม่ได้กำหนดว่าโค้ดของคุณต้องอยู่ที่ใด แต่สำหรับแบบฝึกหัดและโปรเจกต์ในหนังสือเล่มนี้ เราขอแนะนำให้สร้างไดเรกทอรีชื่อ `projects` ใน Home directory ของคุณ และเก็บโปรเจกต์ทั้งหมดไว้ที่นั่น

เปิดเทอร์มินัลและป้อนคำสั่งต่อไปนี้เพื่อสร้างไดเรกทอรี projects และไดเรกทอรีสำหรับโปรเจกต์ "Hello, world!" ภายในไดเรกทอรี projects

สำหรับ Linux, macOS, และ PowerShell บน Windows ให้ป้อนคำสั่งนี้:

```console
$ mkdir ~/projects
$ cd ~/projects
$ mkdir hello_world
$ cd hello_world
```

สำหรับ Windows CMD, ให้ป้อนคำสั่งนี้:

```cmd
> mkdir "%USERPROFILE%\projects"
> cd /d "%USERPROFILE%\projects"
> mkdir hello_world
> cd hello_world
```

### การเขียนและรันโปรแกรม Rust

ต่อไป ให้สร้างไฟล์ Source ใหม่และตั้งชื่อว่า _main.rs_ ไฟล์ Rust จะลงท้ายด้วยนามสกุล .rs เสมอ หากคุณใช้คำมากกว่าหนึ่งคำในชื่อไฟล์ ตามธรรมเนียมแล้วจะใช้อักขระขีดล่าง (_) เพื่อคั่นคำเหล่านั้น ตัวอย่างเช่น ให้ใช้ hello_world.rs แทน helloworld.rs

ตอนนี้ ให้เปิดไฟล์ main.rs ที่คุณเพิ่งสร้างขึ้น และป้อนโค้ดใน Listing 1-1

<Listing number="1-1" file-name="main.rs" caption="A program that prints `Hello, world!`">

```rust
fn main() {
    println!("Hello, world!");
}
```

</Listing>

บันทึกไฟล์ แล้วกลับไปยังหน้าต่างเทอร์มินัลในไดเรกทอรี ~/projects/hello_world บน Linux หรือ macOS ให้ป้อนคำสั่งต่อไปนี้เพื่อคอมไพล์และรันไฟล์:

```console
$ rustc main.rs
$ ./main
Hello, world!
```

บน Windows ให้ป้อนคำสั่ง `.\main.exe` แทน `./main` :

```powershell
> rustc main.rs
> .\main
Hello, world!
```

ไม่ว่าคุณจะใช้ระบบปฏิบัติการใดก็ตาม ข้อความ `Hello, world!` ควรจะแสดงในเทอร์มินัล หากคุณไม่เห็นผลลัพธ์นี้ โปรดย้อนกลับไปดูส่วน "การแก้ไขปัญหา" ในหัวข้อการติดตั้งเพื่อหาวิธีขอความช่วยเหลือ
[“Troubleshooting”][troubleshooting]<!-- ignore -->

หาก Hello, world! แสดงผลออกมา ขอแสดงความยินดีด้วย! คุณได้เขียนโปรแกรม Rust อย่างเป็นทางการแล้ว นั่นทำให้คุณเป็นโปรแกรมเมอร์ Rust แล้ว ยินดีต้อนรับ!

### โครงสร้างของโปรแกรม Rust

มาดูโปรแกรม "Hello, world!" นี้ในรายละเอียดกัน นี่คือส่วนแรกของปริศนา:

```rust
fn main() {

}
```

บรรทัดเหล่านี้กำหนดฟังก์ชันชื่อ `main` ฟังก์ชัน `main` เป็นฟังก์ชันพิเศษ: มันเป็นโค้ดแรกที่จะรันเสมอในทุกโปรแกรม Rust ที่สามารถปฏิบัติการได้ ที่นี่ บรรทัดแรกประกาศฟังก์ชันชื่อ `main` ที่ไม่มีพารามิเตอร์และไม่คืนค่าใดๆ หากมีพารามิเตอร์ พารามิเตอร์เหล่านั้นจะอยู่ในวงเล็บ `()`

ส่วนของฟังก์ชันถูกห่อหุ้มด้วย `{}` Rust กำหนดให้ต้องมีวงเล็บปีกกาครอบส่วนของฟังก์ชันทั้งหมด เป็นรูปแบบที่ดีที่จะวางวงเล็บปีกกาเปิดในบรรทัดเดียวกับการประกาศฟังก์ชัน โดยเว้นวรรคหนึ่งช่อง

หากคุณต้องการยึดตามรูปแบบมาตรฐานในทุกโปรเจกต์ Rust คุณสามารถใช้เครื่องมือจัดรูปแบบอัตโนมัติที่เรียกว่า rustfmt เพื่อจัดรูปแบบโค้ดของคุณในรูปแบบเฉพาะ (รายละเอียดเพิ่มเติมเกี่ยวกับ rustfmt ใน ภาคผนวก D) ทีมงาน Rust ได้รวมเครื่องมือนี้ไว้กับการกระจาย Rust มาตรฐาน เช่นเดียวกับ rustc ดังนั้นจึงควรติดตั้งบนคอมพิวเตอร์ของคุณแล้ว!

> หมายเหตุ: หากคุณต้องการยึดตามรูปแบบมาตรฐานในทุกโปรเจกต์ Rust
> คุณสามารถใช้เครื่องมือจัดรูปแบบอัตโนมัติที่เรียกว่า `rustfmt`เพื่อจัดรูปแบบโค้ดของคุณในรูปแบบเฉพาะ 


ส่วนเนื้อหาของฟังก์ชัน `main` มีโค้ดดังนี้:

```rust
println!("Hello, world!");
```

บรรทัดนี้ทำงานทั้งหมดในโปรแกรมเล็กๆ นี้: มันพิมพ์ข้อความออกทางหน้าจอ มีรายละเอียดสำคัญสี่ประการที่ควรสังเกตที่นี่

ประการแรก `println!` เรียกใช้ Rust macro หากเป็นการเรียกใช้ฟังก์ชัน จะเขียนเป็น `println` (ไม่มี !) เราจะพูดถึง Rust macros ในรายละเอียดเพิ่มเติมใน[Chapter 20][ch20-macros]<!-- ignore -->. สำหรับตอนนี้ คุณเพียงแค่ต้องรู้ว่าการใช้ ! หมายความว่าคุณกำลังเรียกใช้ macro แทนที่จะเป็นฟังก์ชันปกติ และ macros ไม่ได้ทำตามกฎเดียวกันกับฟังก์ชันเสมอไป

ประการที่สอง คุณเห็น String `"Hello, world!"` เราส่ง String นี้เป็นอาร์กิวเมนต์ให้กับ println! และ String นี้จะถูกพิมพ์ออกทางหน้าจอ

ประการที่สาม เราปิดท้ายบรรทัดด้วยเครื่องหมายอัฒภาค (`;`) ซึ่งบ่งชี้ว่านิพจน์นี้สิ้นสุดแล้วและนิพจน์ถัดไปพร้อมที่จะเริ่มต้น บรรทัดส่วนใหญ่ของโค้ด Rust จะลงท้ายด้วยเครื่องหมายอัฒภาค

### การคอมไพล์และการรันเป็นขั้นตอนที่แยกจากกัน

คุณเพิ่งรันโปรแกรมที่สร้างใหม่ ดังนั้นเรามาดูแต่ละขั้นตอนในกระบวนการนี้กัน ก่อนที่จะรันโปรแกรม Rust คุณต้องคอมไพล์มันโดยใช้ Rust compiler โดยการป้อนคำสั่ง `rustc` และตามด้วยชื่อไฟล์ Source ของคุณ ดังนี้: 

```console
$ rustc main.rs
```

หากคุณมีพื้นฐานด้าน C หรือ C++ คุณจะสังเกตเห็นว่าสิ่งนี้คล้ายกับ `gcc` หรือ `clang` หลังจากคอมไพล์สำเร็จแล้ว Rust จะสร้างไฟล์ปฏิบัติการที่เป็น Binary

บน Linux, macOS และ PowerShell บน Windows คุณสามารถดูไฟล์ปฏิบัติการได้โดยการป้อนคำสั่ง `ls` ใน Shell ของคุณ:

```console
$ ls
main  main.rs
```

บน Linux และ macOS คุณจะเห็นไฟล์สองไฟล์ ใน PowerShell บน Windows คุณจะเห็นไฟล์สามไฟล์เดียวกันกับที่คุณเห็นเมื่อใช้ CMD ใน CMD บน Windows คุณจะต้องป้อนคำสั่งต่อไปนี้:

```cmd
> dir /B %= the /B option says to only show the file names =%
main.exe
main.pdb
main.rs
```

สิ่งนี้จะแสดงไฟล์ Source Code ที่มีนามสกุล _.rs_, ไฟล์ปฏิบัติการ (_main.exe_ บน Windows แต่เป็น _main_ บนแพลตฟอร์มอื่นๆ) และเมื่อใช้ Windows จะมีไฟล์ที่มีข้อมูลการดีบักที่มีนามสกุล _.pdb_ จากที่นี่ คุณสามารถรันไฟล์ _main_ หรือ _main.exe_ ได้ดังนี้:


```console
$ ./main # or .\main on Windows
```

หากไฟล์ _main.rs_ ของคุณเป็นโปรแกรม "Hello, world!" บรรทัดนี้จะพิมพ์ Hello, world! ออกมาในเทอร์มินัลของคุณ

หากคุณคุ้นเคยกับภาษา Dynamic เช่น Ruby, Python หรือ JavaScript มากกว่า คุณอาจจะไม่คุ้นเคยกับการคอมไพล์และรันโปรแกรมเป็นขั้นตอนที่แยกจากกัน Rust เป็นภาษาที่ _ahead-of-time compiled_ ซึ่งหมายความว่าคุณสามารถคอมไพล์โปรแกรมและมอบไฟล์ปฏิบัติการให้กับผู้อื่นได้ และพวกเขาสามารถรันมันได้โดยไม่ต้องติดตั้ง Rust หากคุณให้ไฟล์ _.rb_, _.py_ หรือ _.js_ แก่ใครบางคน พวกเขาจะต้องติดตั้ง Ruby, Python หรือ JavaScript implementation (ตามลำดับ) แต่ในภาษาเหล่านั้น คุณเพียงแค่ต้องใช้คำสั่งเดียวในการคอมไพล์และรันโปรแกรมของคุณ ทุกอย่างเป็นการแลกเปลี่ยนในการออกแบบภาษา

การคอมไพล์ด้วย `rustc` เพียงอย่างเดียวก็เพียงพอสำหรับโปรแกรมง่ายๆ แต่เมื่อโปรเจกต์ของคุณเติบโตขึ้น คุณจะต้องจัดการตัวเลือกทั้งหมดและทำให้การแบ่งปันโค้ดของคุณเป็นเรื่องง่าย ต่อไป เราจะแนะนำให้คุณรู้จักกับเครื่องมือ Cargo ซึ่งจะช่วยให้คุณเขียนโปรแกรม Rust ในโลกแห่งความเป็นจริงได้ง่ายขึ้น

[troubleshooting]: ch01-01-installation.html#troubleshooting
[devtools]: appendix-04-useful-development-tools.html
[ch20-macros]: ch20-05-macros.html
